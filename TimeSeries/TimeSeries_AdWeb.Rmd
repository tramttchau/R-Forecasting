---
title: 'Ph√¢n t√≠ch chu·ªói th·ªùi gian: Ad Cost & Viewer Count c·ªßa website c√° nh√¢n'
author: "Ch√¢u Th·ªã Tuy·∫øt Tr√¢m"
date: "2025-06-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Import libraries:**
```{r}
library(dplyr)
library(ggplot2)
library(tseries)
library(forecast)
library(astsa)
library(Metrics)
library(scales)
```

#### *Step 1: Chu·∫©n b·ªã v√† kh√°m ph√° d·ªØ li·ªáu*
**Load d·ªØ li·ªáu:**
```{r}
web_data <- read.csv(file = "final_website_stats.csv")
web_data
```


```{r}
cat("C·∫•u tr√∫c d·ªØ li·ªáu:\n")
str(web_data)
cat("\nK√≠ch th∆∞·ªõc d·ªØ li·ªáu:", dim(web_data), "\n")
cat("T√™n c√°c c·ªôt:", names(web_data), "\n")
```
##### **Th√¥ng tin v·ªÅ b·ªô d·ªØ li·ªáu:**     
         
B·ªô d·ªØ li·ªáu c√≥ t√™n **"Chi ph√≠ qu·∫£ng c√°o & l∆∞·ª£t truy c·∫≠p trang c√° nh√¢n"** (t√™n g·ªëc: *Personal Ecommerce Website Ad Cost & Viewer Count*), ƒë∆∞·ª£c thu th·∫≠p t·ª´ n·ªÅn t·∫£ng Kaggle (https://www.kaggle.com/datasets/michealknight/personal-ecommerce-website-ad-cost-and-viewer-count). D·ªØ li·ªáu bao g·ªìm **1096 quan s√°t h·∫±ng ng√†y**, ghi nh·∫≠n li√™n t·ª•c t·ª´ **ng√†y 01/01/2022 ƒë·∫øn 31/12/2024**, ph·∫£n √°nh l∆∞u l∆∞·ª£ng truy c·∫≠p v√† m·ª©c ƒë·ªô t∆∞∆°ng t√°c c·ªßa ng∆∞·ªùi d√πng tr√™n trang web th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠, cung c·∫•p g√≥c nh√¨n to√†n di·ªán v·ªÅ c√°ch h√†nh vi ng∆∞·ªùi d√πng thay ƒë·ªïi theo th·ªùi gian, ƒë·∫∑c bi·ªát d∆∞·ªõi ·∫£nh h∆∞·ªüng c·ªßa c√°c chi·∫øn d·ªãch qu·∫£ng c√°o v√† c√°c y·∫øu t·ªë th·ªùi ƒëi·ªÉm nh∆∞ cu·ªëi tu·∫ßn ho·∫∑c ng√†y l·ªÖ.     

---

**C√°c bi·∫øn trong b·ªô d·ªØ li·ªáu bao g·ªìm:**    

* **`timestamp`**: Ng√†y ghi nh·∫≠n d·ªØ li·ªáu (t·∫ßn su·∫•t h·∫±ng ng√†y), l√† tr·ª•c th·ªùi gian ch√≠nh c·ªßa chu·ªói th·ªùi gian, k√©o d√†i t·ª´ 01/01/2022 ƒë·∫øn 31/12/2024.     
* **`page_views`**: Trung b√¨nh s·ªë l∆∞·ª£t xem trang trong ng√†y ‚Äì l√† bi·∫øn m·ª•c ti√™u ch√≠nh d√πng ƒë·ªÉ d·ª± b√°o.   
* **`ad_spend`**: S·ªë ti·ªÅn chi ti√™u cho qu·∫£ng c√°o tr·ª±c tuy·∫øn trong ng√†y.    
* **`is_weekend`**: Bi·∫øn nh·ªã ph√¢n cho bi·∫øt ng√†y ƒë√≥ c√≥ ph·∫£i cu·ªëi tu·∫ßn (Th·ª© B·∫£y, Ch·ªß Nh·∫≠t) hay kh√¥ng.    
* **`day_of_week`**: T√™n ng√†y trong tu·∫ßn (Monday, Tuesday,...).     
* **`is_holiday`**: Bi·∫øn nh·ªã ph√¢n th·ªÉ hi·ªán ng√†y ƒë√≥ c√≥ ph·∫£i l√† ng√†y l·ªÖ ho·∫∑c d·ªãp ƒë·∫∑c bi·ªát.    

---
**M·ª•c ti√™u ph√¢n t√≠ch:**    

* üìÖ Ph√°t hi·ªán chu k·ª≥ tu·∫ßn v√† m√πa v·ª• ·∫£nh h∆∞·ªüng ƒë·∫øn h√†nh vi ng∆∞·ªùi d√πng (cu·ªëi tu·∫ßn, ng√†y l·ªÖ).  
* üìä ƒê√°nh gi√° hi·ªáu qu·∫£ qu·∫£ng c√°o th√¥ng qua m·ªëi li√™n h·ªá gi·ªØa chi ti√™u (`ad_spend`) v√† l∆∞·ª£t truy c·∫≠p (`page_views`). 
* üìà D·ª± b√°o s·ªë l∆∞·ª£t xem trang (page views) d·ª±a tr√™n xu h∆∞·ªõng qu√° kh·ª© v√† y·∫øu t·ªë ngo·∫°i sinh nh∆∞ chi ph√≠ qu·∫£ng c√°o, ng√†y ngh·ªâ.   
  

##### **Chuy·ªÉn ƒë·ªïi c√°c bi·∫øn sang ƒë·ªãnh d·∫°ng ph√π h·ª£p:**   
```{r}
# Chuy·ªÉn ƒë·ªïi ƒë·ªãnh d·∫°ng ng√†y th√°ng
web_data$timestamp <- as.Date(web_data$timestamp, format = "%m/%d/%Y")

# T·∫°o c·ªôt m·ªõi: d·∫°ng factor (ƒë·ªÉ bi·ªÉu di·ªÖn tr·ª±c quan)
web_data$is_weekend_factor <- factor(web_data$is_weekend, levels = c(TRUE, FALSE), labels = c("Weekend", "Weekday"))
web_data$is_holiday_factor <- factor(web_data$is_holiday, levels = c(TRUE, FALSE), labels = c("Holiday", "Non-Holiday"))

# T·∫°o c·ªôt m·ªõi: d·∫°ng numeric (d√πng cho m√¥ h√¨nh)
web_data$is_weekend_num <- as.numeric(web_data$is_weekend)  # TRUE -> 1, FALSE -> 0
web_data$is_holiday_num <- as.numeric(web_data$is_holiday)

# Thi·∫øt l·∫≠p th·ª© t·ª± ng√†y trong tu·∫ßn
web_data$day_of_week <- factor(
  web_data$day_of_week,
  levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"),
  ordered = TRUE
)

str(web_data)
summary(web_data)
```
T·ª´ b·∫£ng m√¥ t·∫£ d·ªØ li·ªáu:    

* **page_views** (l∆∞·ª£t xem trang): trung b√¨nh m·ªói ng√†y c√≥ kho·∫£ng **1553 l∆∞·ª£t xem**, dao ƒë·ªông t·ª´ **868 ƒë·∫øn 2287**. ƒêi·ªÅu n√†y cho th·∫•y l∆∞·ª£ng truy c·∫≠p c√≥ s·ª± bi·∫øn ƒë·ªông ƒë√°ng k·ªÉ gi·ªØa c√°c ng√†y.    
* **ad_spend** (chi ph√≠ qu·∫£ng c√°o): trung b√¨nh m·ªói ng√†y chi 249.5 ƒë∆°n v·ªã ti·ªÅn t·ªá, dao ƒë·ªông t·ª´ 113 ƒë·∫øn g·∫ßn 680, cho th·∫•y c√≥ s·ª± kh√°c bi·ªát l·ªõn gi·ªØa c√°c ng√†y ‚Äì ph·∫£n √°nh c√°c chi·∫øn d·ªãch qu·∫£ng c√°o kh√°c nhau.     
* **is_weekend**: c√≥ **314/1096 ng√†y** l√† cu·ªëi tu·∫ßn (kho·∫£ng 28.65%), c√≤n l·∫°i l√† ng√†y th∆∞·ªùng.      
* **is_holiday**: ch·ªâ c√≥ **12 ng√†y l√† ng√†y l·ªÖ** trong to√†n b·ªô t·∫≠p d·ªØ li·ªáu (kho·∫£ng 1.1%), cho th·∫•y y·∫øu t·ªë n√†y kh√° hi·∫øm nh∆∞ng c√≥ th·ªÉ ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn h√†nh vi ng∆∞·ªùi d√πng.   
* **day_of_week** ƒë∆∞·ª£c ph√¢n b·ªë ƒë·ªìng ƒë·ªÅu, m·ªói th·ª© c√≥ kho·∫£ng 156‚Äì157 ng√†y ‚Äî x√°c nh·∫≠n d·ªØ li·ªáu theo t·∫ßn su·∫•t h√†ng ng√†y li√™n t·ª•c kh√¥ng thi·∫øu s√≥t.     
* D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω th√™m ƒë·ªÉ c√≥ c√°c bi·∫øn d·∫°ng s·ªë (`0/1`) v√† bi·∫øn ƒë·ªãnh danh (`factor`) t∆∞∆°ng ·ª©ng v·ªõi `is_weekend` v√† `is_holiday`, h·ªó tr·ª£ c·∫£ m·ª•c ti√™u m√¥ h√¨nh h√≥a v√† tr·ª±c quan h√≥a.             

##### **Ki·ªÉm tra Missing Value:**
```{r}
# T·ªïng s·ªë gi√° tr·ªã NA to√†n b·ªô dataset
sum(is.na(web_data))

# S·ªë l∆∞·ª£ng NA theo t·ª´ng bi·∫øn
colSums(is.na(web_data))
```

$\rightarrow$ Kh√¥ng c√≥ gi√° tr·ªã NA trong b·ªô d·ªØ li·ªáu.   

##### **Ki·ªÉm tra gi√° tr·ªã ngo·∫°i lai (Outliers):**   

S·ª≠ d·ª•ng quy t·∫Øc IQR (Interquartile Range ‚Äì kho·∫£ng t·ª© ph√¢n v·ªã) cho c√°c bi·∫øn ƒë·ªãnh l∆∞·ª£ng ƒë·ªÉ ph√°t hi·ªán outlier v·ªõi IQR ƒë∆∞·ª£c t√≠nh b·∫±ng:

$$
IQR = Q_3 - Q_1
$$

Trong ƒë√≥:    

* $Q_1$: Ph√¢n v·ªã th·ª© nh·∫•t (25%)   
* $Q_3$: Ph√¢n v·ªã th·ª© ba (75%)   

M·ªôt quan s√°t ƒë∆∞·ª£c xem l√† **ngo·∫°i lai** n·∫øu n√≥ n·∫±m ngo√†i kho·∫£ng:$[Q_1 - 1.5 \times IQR,\quad Q_3 + 1.5 \times IQR]$, t·ª©c l√† nh·ªØng gi√° tr·ªã nh·ªè h∆°n $Q_1 - 1.5 \times IQR$ ho·∫∑c l·ªõn h∆°n $Q_3 + 1.5 \times IQR$ ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† outliers.    

```{r}
# H√†m ki·ªÉm tra outlier theo IQR
check_outliers <- function(x) {
  Q1 <- quantile(x, 0.25, na.rm = TRUE)
  Q3 <- quantile(x, 0.75, na.rm = TRUE)
  IQR <- Q3 - Q1
  lower_bound <- Q1 - 1.5 * IQR
  upper_bound <- Q3 + 1.5 * IQR
  return(which(x < lower_bound | x > upper_bound))
}

# Ch·ªâ ki·ªÉm tra cho c√°c bi·∫øn ƒë·ªãnh l∆∞·ª£ng
out_page_views <- check_outliers(web_data$page_views)
out_ad_spend   <- check_outliers(web_data$ad_spend)

# S·ªë l∆∞·ª£ng outlier
length(out_page_views)
length(out_ad_spend)
```
Boxplot tr·ª±c quan h√≥a outlier:   
```{r}
boxplot(web_data$page_views, main = "Boxplot - Page Views", col = "skyblue")
boxplot(web_data$ad_spend, main = "Boxplot - Ad Spend", col = "orange")
```

Nh·∫≠n x√©t:    

  - Bi·∫øn `page_views` (l∆∞·ª£t xem trang):    
    + Bi·ªÉu ƒë·ªì h·ªôp cho th·∫•y ph√¢n ph·ªëi c·ªßa l∆∞·ª£t xem trang kh√° ƒë·ªÅu, t·∫≠p trung ch·ªß y·∫øu quanh gi√° tr·ªã trung v·ªã.    
    + Kh√¥ng c√≥ gi√° tr·ªã ngo·∫°i lai (outlier) ƒë√°ng k·ªÉ, cho th·∫•y d·ªØ li·ªáu n√†y kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi c√°c ƒë·ªôt bi·∫øn l·ªõn trong h√†nh vi ng∆∞·ªùi d√πng.   
    + Kho·∫£ng gi·ªØa (IQR) tr·∫£i r·ªông t·ª´ kho·∫£ng 1350 ƒë·∫øn 1750, cho th·∫•y s·ª± dao ƒë·ªông t·ª± nhi√™n c·ªßa l∆∞u l∆∞·ª£ng truy c·∫≠p theo ng√†y l√† t∆∞∆°ng ƒë·ªëi ·ªïn ƒë·ªãnh.    

  - Bi·∫øn `ad_spend` (chi ph√≠ qu·∫£ng c√°o):       
    + D·ªØ li·ªáu chi ti√™u qu·∫£ng c√°o c√≥ ph√¢n ph·ªëi l·ªách ph·∫£i r√µ r·ªát v√† ch·ª©a nhi·ªÅu gi√° tr·ªã ngo·∫°i lai (77/1096 quan s√°t) v∆∞·ª£t xa kh·ªèi kho·∫£ng IQR.       
    + C√°c gi√° tr·ªã outlier n√†y ƒë·∫°i di·ªán cho nh·ªØng ng√†y c√≥ m·ª©c chi ti√™u cao h∆°n m·ª©c trung b√¨nh ƒë√°ng k·ªÉ ‚Äî c√≥ th·ªÉ l√† c√°c chi·∫øn d·ªãch qu·∫£ng c√°o ƒë·∫∑c bi·ªát.     
    + D√π l√† ngo·∫°i lai theo ph∆∞∆°ng ph√°p IQR, nh∆∞ng nh·ªØng gi√° tr·ªã n√†y c√≥ th·ªÉ ch·ª©a ƒë·ª±ng th√¥ng tin quan tr·ªçng, ƒë·∫∑c bi·ªát khi ph√¢n t√≠ch hi·ªáu qu·∫£ marketing v√† m√¥ h√¨nh h√≥a m·ªëi quan h·ªá v·ªõi `page_views`. Do ƒë√≥, kh√¥ng n√™n lo·∫°i b·ªè ngay c√°c gi√° tr·ªã ngo·∫°i lai c·ªßa `ad_spend`.   


##### **Ki·ªÉm tra t√≠nh d·ª´ng (Stationarity):**    
Gi·∫£ thuy·∫øt ki·ªÉm ƒë·ªãnh Augmented Dickey-Fuller - ADF:   

* $H_0$: non-stationary.
* $H_1$: stationary.

p-value:    

* $p-value < 0.05$: b√°c b·ªè H0, k·∫øt lu·∫≠n chu·ªói d·ª´ng.   
* $p-value \geqslant 0.05$: kh√¥ng ƒë·ªß c∆° s·ªü b√°c b·ªè H0, k·∫øt lu·∫≠n chu·ªói kh√¥ng d·ª´ng.    

```{r, warning=FALSE}
# Chuy·ªÉn ƒë·ªïi page_views th√†nh chu·ªói th·ªùi gian v·ªõi t·∫ßn su·∫•t h√†ng ng√†y (frequency = 1) v√† h√†ng tu·∫ßn (frequency = 7)
ts_page_views_1 <- ts(web_data$page_views, frequency = 1)
ts_page_views <- ts(web_data$page_views, frequency = 7)

# Th·ª±c hi·ªán ki·ªÉm ƒë·ªãnh ADF
adf_result_1 <- adf.test(ts_page_views_1, alternative = "stationary")
adf_result <- adf.test(ts_page_views, alternative = "stationary")

# In k·∫øt qu·∫£
print(adf_result_1)
print(adf_result)
```

Gi√° tr·ªã p-value nh·ªè h∆°n 0.05, ta b√°c b·ªè gi·∫£ thuy·∫øt $H_0$ ‚Äì t·ª©c chu·ªói l√† d·ª´ng (stationary), do ƒë√≥ c√≥ th·ªÉ ph√π h·ª£p ƒë·ªÉ √°p d·ª•ng m√¥ h√¨nh ARMA/SARIMA tr·ª±c ti·∫øp ho·∫∑c ti·∫øp t·ª•c ki·ªÉm tra th√†nh ph·∫ßn m√πa v·ª•.   

##### **Ki·ªÉm tra hi·ªán t∆∞·ª£ng heteroscedasticity** - ph∆∞∆°ng sai thay ƒë·ªïi theo th·ªùi gian.       
```{r}
plot(ts_page_views_1, main = "Time Series Plot of Page Views (frequency = 1)")
```

Khi quan s√°t chu·ªói page_views, ta th·∫•y:   

* Bi√™n ƒë·ªô dao ƒë·ªông tƒÉng d·∫ßn theo th·ªùi gian, t·ª´ kho·∫£ng 1200‚Äì1400 ·ªü giai ƒëo·∫°n ƒë·∫ßu l√™n ƒë·∫øn 1600‚Äì2200 v·ªÅ sau. ƒê√¢y l√† d·∫•u hi·ªáu tr·ª±c quan c√≥ th·ªÉ cho th·∫•y chu·ªói c√≥ th·ªÉ c√≥ hi·ªán t∆∞·ª£ng heteroscedasticity.   

* Tuy nhi√™n, ƒë·ªÉ ƒë√°nh gi√° ch√≠nh x√°c h∆°n, ta s·ª≠ d·ª•ng bi·∫øn ƒë·ªïi Box-Cox.   

##### **Ki·ªÉm tra t√≠nh ·ªïn ƒë·ªãnh ph∆∞∆°ng sai v·ªõi bi·∫øn ƒë·ªïi Box-Cox** ƒë·ªÉ ƒë√°nh gi√° xem chu·ªói `page_views` c√≥ c·∫ßn bi·∫øn ƒë·ªïi ƒë·ªÉ ·ªïn ƒë·ªãnh ph∆∞∆°ng sai hay kh√¥ng.    

* N·∫øu $\lambda \approx 1$ $\rightarrow$ kh√¥ng c·∫ßn bi·∫øn ƒë·ªïi.     
* N·∫øu $\lambda < 1$ $\rightarrow$ n√™n d√πng bi·∫øn ƒë·ªïi (log, cƒÉn b·∫≠c hai, ...) ƒë·ªÉ ·ªïn ƒë·ªãnh ph∆∞∆°ng sai.     

```{r}
lambda_1 <- BoxCox.lambda(ts_page_views_1)   # frequency = 1
lambda_1

lambda <- BoxCox.lambda(ts_page_views)        # frequency = 7
lambda
```

* Gi√° tr·ªã $\lambda = 0.91$ v√† $\lambda = 1.09$ ƒë·ªÅu g·∫ßn b·∫±ng 1 cho th·∫•y ph∆∞∆°ng sai c·ªßa chu·ªói `page_views` l√† g·∫ßn ·ªïn ƒë·ªãnh, kh√¥ng c√≥ d·∫•u hi·ªáu heteroscedasticity nghi√™m tr·ªçng. Do ƒë√≥, kh√¥ng c·∫ßn √°p d·ª•ng bi·∫øn ƒë·ªïi Box-Cox (nh∆∞ log ho·∫∑c cƒÉn b·∫≠c hai) tr∆∞·ªõc khi m√¥ h√¨nh h√≥a.     


#### *Step 2: Ph√°t hi·ªán chu k·ª≥ tu·∫ßn v√† m√πa v·ª• ·∫£nh h∆∞·ªüng ƒë·∫øn h√†nh vi ng∆∞·ªùi d√πng (cu·ªëi tu·∫ßn, ng√†y l·ªÖ):*      

Tr∆∞·ªõc khi x√¢y d·ª±ng m√¥ h√¨nh d·ª± b√°o, vi·ªác kh√°m ph√° d·ªØ li·ªáu ban ƒë·∫ßu (exploratory data analysis ‚Äì EDA) l√† b∆∞·ªõc quan tr·ªçng nh·∫±m hi·ªÉu r√µ ƒë·∫∑c ƒëi·ªÉm c·∫•u tr√∫c chu·ªói. ƒê·∫∑c bi·ªát, vi·ªác ki·ªÉm tra xu h∆∞·ªõng theo th·ªùi gian, chu k·ª≥ m√πa v·ª•, v√† ·∫£nh h∆∞·ªüng c·ªßa c√°c y·∫øu t·ªë b√™n ngo√†i (nh∆∞ chi ti√™u qu·∫£ng c√°o) gi√∫p ƒë·ªãnh h∆∞·ªõng l·ª±a ch·ªçn m√¥ h√¨nh v√† gi·∫£i th√≠ch k·∫øt qu·∫£ h·ª£p l√Ω h∆°n.    

**Page Views v√† Ad Spend theo th·ªùi gian:**   
```{r}
ggplot(web_data, aes(x = timestamp)) +
  geom_line(aes(y = page_views, color = "Page Views")) +
  geom_line(aes(y = ad_spend * max(page_views) / max(ad_spend), color = "Ad Spend")) +
  scale_y_continuous(
    name = "Page Views",
    sec.axis = sec_axis(~ . * max(web_data$ad_spend) / max(web_data$page_views), name = "Ad Spend")
  ) +
  scale_color_manual(values = c("Page Views" = "steelblue", "Ad Spend" = "tomato")) +
  labs(title = "Page Views v√† Ad Spend theo th·ªùi gian", x = "Ng√†y") +
  theme_minimal()
```

Nh·∫≠n x√©t:    

1. **Xu h∆∞·ªõng t·ªïng th·ªÉ:**     

   * `Page Views` (l∆∞·ª£t xem trang) v√† `Ad Spend` (chi ti√™u qu·∫£ng c√°o) ƒë·ªÅu c√≥ xu h∆∞·ªõng tƒÉng d·∫ßn theo th·ªùi gian t·ª´ nƒÉm 2022 ƒë·∫øn 2024. ƒêi·ªÅu n√†y cho th·∫•y ho·∫°t ƒë·ªông qu·∫£ng b√° c≈©ng nh∆∞ m·ª©c ƒë·ªô ph·ªï bi·∫øn c·ªßa website ƒëang tƒÉng tr∆∞·ªüng ƒë·ªÅu ƒë·∫∑n.    

2. **Bi·∫øn ƒë·ªông ng·∫Øn h·∫°n:**     

   * `Ad Spend` c√≥ nhi·ªÅu bi·∫øn ƒë·ªông m·∫°nh, v·ªõi c√°c ƒë·ªânh cao r√µ r·ªát ‚Äì ph·∫£n √°nh c√°c chi·∫øn d·ªãch qu·∫£ng c√°o ng·∫Øn h·∫°n, c√≥ th·ªÉ l√† d·ªãp ƒë·∫∑c bi·ªát, s·ª± ki·ªán, ho·∫∑c d·ªãp l·ªÖ.    
   * `Page Views` c√≥ s·ª± dao ƒë·ªông nh·∫π h∆°n, th·ªÉ hi·ªán ph·∫£n ·ª©ng t·ª± nhi√™n c·ªßa ng∆∞·ªùi d√πng nh∆∞ng v·∫´n c√≥ nh·ªØng bi·∫øn ƒë·ªông t∆∞∆°ng ·ª©ng v·ªõi c√°c ƒë·ª£t chi ti√™u qu·∫£ng c√°o.

3. **T∆∞∆°ng quan tr·ª±c quan:**           

   * C√≥ nhi·ªÅu th·ªùi ƒëi·ªÉm m√† s·ª± gia tƒÉng c·ªßa `Ad Spend` tr√πng v·ªõi s·ª± tƒÉng nh·∫π c·ªßa `Page Views`, ƒë·∫∑c bi·ªát ·ªü nh·ªØng ƒë·ªânh chi ti√™u l·ªõn ‚Äì ƒëi·ªÅu n√†y g·ª£i √Ω m·ªëi li√™n h·ªá t√≠ch c·ª±c gi·ªØa qu·∫£ng c√°o v√† l∆∞·ª£t truy c·∫≠p.   
   * Tuy nhi√™n, kh√¥ng ph·∫£i l√∫c n√†o tƒÉng chi ti√™u c≈©ng k√©o theo tƒÉng ngay `Page Views`, cho th·∫•y c·∫ßn th√™m ph√¢n t√≠ch ƒë·ªÉ x√°c ƒë·ªãnh ƒë·ªô tr·ªÖ th·ªùi gian (lag effect) ho·∫∑c hi·ªáu qu·∫£ theo ng·ªØ c·∫£nh (ng√†y th∆∞·ªùng vs ng√†y l·ªÖ/cu·ªëi tu·∫ßn).    

4. **Chu k·ª≥ th·ªùi gian:**    

   * C·∫£ hai chu·ªói ƒë·ªÅu th·ªÉ hi·ªán t√≠nh m√πa v·ª• nh·∫π, ƒë·∫∑c bi·ªát l√† nh·ªØng dao ƒë·ªông ng·∫Øn h·∫°n l·∫∑p l·∫°i ƒë·ªãnh k·ª≥ ‚Äì c√≥ th·ªÉ li√™n quan ƒë·∫øn cu·ªëi tu·∫ßn, ƒë·∫ßu th√°ng ho·∫∑c ng√†y l·ªÖ.
   * M·∫≠t ƒë·ªô d√†y ƒë·∫∑c c·ªßa `Page Views` theo d·∫°ng s√≥ng ƒë·ªÅu ƒë·∫∑n do ƒë√≥ c√≥ th·ªÉ c√≥ chu k·ª≥ tu·∫ßn ho·∫∑c th√°ng.   


**Ph√¢n ph·ªëi Page Views theo Ng√†y Cu·ªëi Tu·∫ßn / Ng√†y Th∆∞·ªùng:**    
```{r}
ggplot(web_data, aes(x = is_weekend_factor, y = page_views, fill = is_weekend_factor)) +
  geom_boxplot() +
  labs(title = "Ph√¢n ph·ªëi Page Views theo Ng√†y Cu·ªëi Tu·∫ßn/Ng√†y Th∆∞·ªùng",
       x = "", y = "L∆∞·ª£t xem trang") +
  theme_minimal()
```

Nh·∫≠n x√©t:     

1. **L∆∞·ª£t xem trang c√≥ xu h∆∞·ªõng cao h∆°n v√†o cu·ªëi tu·∫ßn:**

   * Trung v·ªã (median) c·ªßa `Page Views` v√†o cu·ªëi tu·∫ßn (Weekend) cao h∆°n so v·ªõi ng√†y th∆∞·ªùng (Weekday). ƒêi·ªÅu n√†y cho th·∫•y ng∆∞·ªùi d√πng c√≥ xu h∆∞·ªõng truy c·∫≠p trang web nhi·ªÅu h∆°n v√†o cu·ªëi tu·∫ßn.   

2. **ƒê·ªô ph√¢n t√°n c≈©ng cao h∆°n v√†o cu·ªëi tu·∫ßn:**     

   * Chi·ªÅu cao c·ªßa h·ªôp (interquartile range ‚Äì IQR) v√†o cu·ªëi tu·∫ßn l·ªõn h∆°n ‚Üí bi·∫øn ƒë·ªông l∆∞·ª£t xem trang cao h∆°n so v·ªõi ng√†y th∆∞·ªùng.     

**Ph√¢n ph·ªëi Page Views theo Ng√†y l·ªÖ:**    
```{r}
ggplot(web_data, aes(x = is_holiday_factor, y = page_views, fill = is_holiday_factor)) +
  geom_boxplot() +
  labs(title = "Ph√¢n ph·ªëi Page Views theo Ng√†y l·ªÖ",
       x = "", y = "L∆∞·ª£t xem trang") +
  theme_minimal()
```

* Trung v·ªã l∆∞·ª£t xem trang trong ng√†y l·ªÖ cao h∆°n so v·ªõi ng√†y th∆∞·ªùng, cho th·∫•y xu h∆∞·ªõng truy c·∫≠p tƒÉng trong c√°c d·ªãp l·ªÖ.    
* ƒê·ªô ph√¢n t√°n (kho·∫£ng t·ª© ph√¢n v·ªã) trong nh√≥m ng√†y th∆∞·ªùng r·ªông h∆°n, ph·∫£n √°nh s·ª± bi·∫øn ƒë·ªông l·ªõn h∆°n v·ªÅ l∆∞·ª£ng truy c·∫≠p so v·ªõi ng√†y l·ªÖ.   
* Nh√≥m ng√†y l·ªÖ c√≥ xu·∫•t hi·ªán m·ªôt s·ªë ƒëi·ªÉm ngo·∫°i lai (outlier) v·ªõi gi√° tr·ªã th·∫•p, c√≥ th·ªÉ do m·ªôt s·ªë ng√†y l·ªÖ kh√¥ng tr√πng v·ªõi c√°c chi·∫øn d·ªãch qu·∫£ng b√° ho·∫∑c c√≥ √≠t nhu c·∫ßu truy c·∫≠p.   
* L∆∞·ª£t xem t·ªëi ƒëa trong ng√†y th∆∞·ªùng l·∫°i cao h∆°n ƒë√°ng k·ªÉ so v·ªõi ng√†y l·ªÖ, cho th·∫•y c√≥ nh·ªØng ng√†y th∆∞·ªùng ƒë·∫°t ƒë∆∞·ª£c l∆∞·ª£ng truy c·∫≠p v∆∞·ª£t tr·ªôi, c√≥ th·ªÉ nh·ªù hi·ªáu qu·∫£ t·ª´ qu·∫£ng c√°o ho·∫∑c n·ªôi dung h·∫•p d·∫´n.   
 

##### **Ki·ªÉm tra chu k·ª≥ m√πa v·ª•:**      
ƒê·ªÉ x√°c ƒë·ªãnh c·∫•u tr√∫c ph·ª• thu·ªôc th·ªùi gian trong chu·ªói `page_views`, ta s·ª≠ d·ª•ng hai c√¥ng c·ª• ph·ªï bi·∫øn trong ph√¢n t√≠ch chu·ªói th·ªùi gian l√† h√†m t·ª± t∆∞∆°ng quan (ACF) v√† h√†m t·ª± t∆∞∆°ng quan ri√™ng ph·∫ßn (PACF):     

* **H√†m t·ª± t∆∞∆°ng quan (ACF - Autocorrelation Function):**    
  ƒêo l∆∞·ªùng m·ª©c ƒë·ªô t∆∞∆°ng quan gi·ªØa gi√° tr·ªã hi·ªán t·∫°i c·ªßa chu·ªói v·ªõi c√°c gi√° tr·ªã qu√° kh·ª© ·ªü nhi·ªÅu ƒë·ªô tr·ªÖ (lags). ACF h·ªØu √≠ch ƒë·ªÉ x√°c ƒë·ªãnh th√†nh ph·∫ßn MA (Moving Average) trong m√¥ h√¨nh ARIMA, c≈©ng nh∆∞ nh·∫≠n di·ªán t√≠nh m√πa v·ª• (seasonality) n·∫øu c√≥ m·∫´u l·∫∑p ƒë·ªÅu ƒë·∫∑n.  

* **H√†m t·ª± t∆∞∆°ng quan ri√™ng ph·∫ßn (PACF - Partial Autocorrelation Function):**   
  ƒêo l∆∞·ªùng t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong chu·ªói v·ªõi c√°c gi√° tr·ªã qu√° kh·ª© t·∫°i m·ªôt ƒë·ªô tr·ªÖ nh·∫•t ƒë·ªãnh, lo·∫°i b·ªè ·∫£nh h∆∞·ªüng gi√°n ti·∫øp c·ªßa c√°c ƒë·ªô tr·ªÖ trung gian. PACF th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x√°c ƒë·ªãnh b·∫≠c c·ªßa th√†nh ph·∫ßn AR (AutoRegressive).    
  
```{r}
acf(ts_page_views, lag.max = 60)
pacf(ts_page_views, lag.max = 60)
```

Quan s√°t t·ª´ bi·ªÉu ƒë·ªì:  

* ACF th·ªÉ hi·ªán c√°c ƒë·ªânh n·ªïi b·∫≠t t·∫°i c√°c ƒë·ªô tr·ªÖ l√† b·ªôi s·ªë c·ªßa 7 (lag = 7, 14, 21, ...), cho th·∫•y chu·ªói c√≥ m√πa v·ª• theo tu·∫ßn.   
* PACF c√≥ nhi·ªÅu gi√° tr·ªã v∆∞·ª£t ng∆∞·ª°ng tin c·∫≠y trong kho·∫£ng t·ª´ lag = 1 ƒë·∫øn 4, sau ƒë√≥ gi·∫£m d·∫ßn v√† dao ƒë·ªông quanh 0, th·ªÉ hi·ªán ·∫£nh h∆∞·ªüng m·∫°nh m·∫Ω c·ªßa c√°c gi√° tr·ªã g·∫ßn trong qu√° kh·ª©.    


#### *Step 3: ƒê√°nh gi√° hi·ªáu qu·∫£ qu·∫£ng c√°o th√¥ng qua m·ªëi li√™n h·ªá gi·ªØa chi ti√™u (`ad_spend`) v√† l∆∞·ª£t truy c·∫≠p (`page_views`).* 

**M·ªëi quan h·ªá gi·ªØa Chi ti√™u qu·∫£ng c√°o v√† L∆∞·ª£t xem trang:**           

ƒê·ªÉ ƒë√°nh gi√° hi·ªáu qu·∫£ c·ªßa c√°c chi·∫øn d·ªãch qu·∫£ng c√°o, m·ªôt c√°ch ti·∫øp c·∫≠n ƒë∆°n gi·∫£n l√† ki·ªÉm tra m·ªëi quan h·ªá gi·ªØa chi ti√™u qu·∫£ng c√°o (`ad_spend`) v√† h√†nh vi ng∆∞·ªùi d√πng (`page_views`). Trong tr∆∞·ªùng h·ª£p l√Ω t∆∞·ªüng, ta k·ª≥ v·ªçng r·∫±ng khi chi ti√™u tƒÉng th√¨ l∆∞·ª£t xem trang s·∫Ω tƒÉng t∆∞∆°ng ·ª©ng. Ph√¢n t√≠ch h·ªìi quy tuy·∫øn t√≠nh v√† h·ªá s·ªë t∆∞∆°ng quan Pearson l√† hai c√¥ng c·ª• c∆° b·∫£n gi√∫p ki·ªÉm ƒë·ªãnh gi·∫£ thuy·∫øt n√†y.   

```{r}
# Scatter plot gi·ªØa ad_spend v√† page_views
ggplot(web_data, aes(x = ad_spend, y = page_views)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red", linewidth = 1) +
  labs(title = "M·ªëi quan h·ªá gi·ªØa Chi ti√™u qu·∫£ng c√°o v√† L∆∞·ª£t xem trang",
       x = "Ad Spend", y = "Page Views") +
  theme_minimal()

```

Nh·∫≠n x√©t:       

1. **M·ªëi quan h·ªá g·∫ßn nh∆∞ kh√¥ng r√µ r√†ng (r·∫•t y·∫øu):**

   * ƒê∆∞·ªùng h·ªìi quy tuy·∫øn t√≠nh (m√†u ƒë·ªè) g·∫ßn nh∆∞ n·∫±m ngang. ƒêi·ªÅu n√†y cho th·∫•y kh√¥ng c√≥ xu h∆∞·ªõng tƒÉng hay gi·∫£m r√µ r·ªát gi·ªØa chi ti√™u qu·∫£ng c√°o v√† l∆∞·ª£t xem trang.   

2. **Ph√¢n t√°n cao v√† kh√¥ng ƒë·ªìng ƒë·ªÅu:**

   * C√°c ƒëi·ªÉm d·ªØ li·ªáu r·∫£i r√°c kh√° r·ªông, ƒë·∫∑c bi·ªát l√† v·ªõi c√°c m·ª©c chi ti√™u th·∫•p (t·∫≠p trung nhi·ªÅu ·ªü kho·∫£ng d∆∞·ªõi 300). ƒêi·ªÅu n√†y cho th·∫•y bi·∫øn `page_views` ch·ªãu ·∫£nh h∆∞·ªüng c·ªßa nhi·ªÅu y·∫øu t·ªë kh√°c, kh√¥ng ch·ªâ ri√™ng `ad_spend`.

3. **D·∫£i tin c·∫≠y (confidence band):** V√πng x√°m th·ªÉ hi·ªán ƒë·ªô kh√¥ng ch·∫Øc ch·∫Øn cao, nh·∫•t l√† ·ªü c√°c m·ª©c chi ti√™u cao, n∆°i d·ªØ li·ªáu th∆∞a h∆°n. 


**Ph√¢n t√≠ch t∆∞∆°ng quan:**  
```{r}
cor(web_data$ad_spend, web_data$page_views, use = "complete.obs")
```
K·∫øt qu·∫£: -0.0035.     

H·ªá s·ªë n√†y r·∫•t g·∫ßn 0, cho th·∫•y kh√¥ng c√≥ m·ªëi t∆∞∆°ng quan tuy·∫øn t√≠nh ƒë√°ng k·ªÉ gi·ªØa hai bi·∫øn. Vi·ªác chi ti√™u nhi·ªÅu h∆°n kh√¥ng ƒë·ªìng nghƒ©a v·ªõi vi·ªác s·ªë l∆∞·ª£t xem tƒÉng, √≠t nh·∫•t l√† theo xu h∆∞·ªõng tuy·∫øn t√≠nh.    


Sau khi th·ª≠ ki·ªÉm tra m·ªëi quan h·ªá tuy·∫øn t√≠nh gi·ªØa bi·∫øn chi ti√™u qu·∫£ng c√°o (`ad_spend`) v√† l∆∞·ª£t xem trang (`page_views`), k·∫øt qu·∫£ cho th·∫•y l∆∞·ª£ng truy c·∫≠p trang kh√¥ng tƒÉng ƒë·ªÅu theo chi ti√™u qu·∫£ng c√°o, m√† c√≥ th·ªÉ ch·ªãu ·∫£nh h∆∞·ªüng b·ªüi nhi·ªÅu y·∫øu t·ªë kh√°c nh∆∞ th·ªùi ƒëi·ªÉm, n·ªôi dung, b·ªëi c·∫£nh, ... M√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh ch·ªâ ph√π h·ª£p khi t·ªìn t·∫°i m·ªëi quan h·ªá ƒë∆°n ƒëi·ªáu v√† tuy·∫øn t√≠nh gi·ªØa c√°c bi·∫øn, ƒëi·ªÅu n√†y kh√¥ng ƒë√∫ng v·ªõi d·ªØ li·ªáu hi·ªán t·∫°i.    

##### **Ph√¢n t√≠ch ƒë·ªô tr·ªÖ (lag) gi·ªØa `ad_spend` v√† `page_views`:**    

Trong c√°c h·ªá th·ªëng c√≥ ph·∫£n ·ª©ng tr·ªÖ, v√≠ d·ª• nh∆∞ hi·ªáu ·ª©ng qu·∫£ng c√°o, t√°c ƒë·ªông c·ªßa bi·∫øn n√†y l√™n bi·∫øn kia th∆∞·ªùng kh√¥ng x·∫£y ra ƒë·ªìng th·ªùi m√† c√≥ th·ªÉ k√©o d√†i v√†i ng√†y. H√†m t∆∞∆°ng quan ch√©o (Cross-correlation Function ‚Äì CCF) l√† c√¥ng c·ª• gi√∫p ki·ªÉm tra xem chu·ªói x c√≥ ·∫£nh h∆∞·ªüng t·ªõi chu·ªói y sau m·ªôt s·ªë ƒë·ªô tr·ªÖ nh·∫•t ƒë·ªãnh hay kh√¥ng.     

```{r}
ccf(web_data$ad_spend, web_data$page_views, lag.max = 30)
```

Gi·∫£i th√≠ch:   

* Lag > 0: `ad_spend` ƒëi tr∆∞·ªõc `page_views` -> ph√¢n t√≠ch li·ªáu qu·∫£ng c√°o c√≥ ·∫£nh h∆∞·ªüng t·ªõi l∆∞·ª£t xem sau ƒë√≥ kh√¥ng.   
* Lag < 0: `page_views` ƒëi tr∆∞·ªõc `ad_spend` -> kh√≥ c√≥ √Ω nghƒ©a th·ª±c ti·ªÖn.    

C√≥ nhi·ªÅu gi√° tr·ªã CCF d∆∞∆°ng ƒë√°ng k·ªÉ t·∫°i ƒë·ªô tr·ªÖ d∆∞∆°ng (v√≠ d·ª•: Lag = 2, 3, 9, 10, ...). Cho th·∫•y chi ti√™u qu·∫£ng c√°o c√≥ t∆∞∆°ng quan d∆∞∆°ng r√µ r·ªát v·ªõi l∆∞·ª£t xem sau v√†i ng√†y.     

M·ªôt s·ªë gi√° tr·ªã t·∫°i Lag < 0 v∆∞·ª£t kho·∫£ng tin c·∫≠y, nh∆∞ng kh√≥ c√≥ √Ω nghƒ©a v√¨ qu·∫£ng c√°o kh√¥ng th·ªÉ b·ªã ·∫£nh h∆∞·ªüng b·ªüi l∆∞·ª£t xem trong t∆∞∆°ng lai.     
Ph√¢n t√≠ch CCF cho th·∫•y chi ti√™u qu·∫£ng c√°o c√≥ ·∫£nh h∆∞·ªüng ƒë·∫øn l∆∞·ª£t truy c·∫≠p sau 2 ƒë·∫øn 3 ng√†y. ƒê√¢y l√† b·∫±ng ch·ª©ng cho th·∫•y c√≥ hi·ªáu ·ª©ng tr·ªÖ (lag effect) trong ph·∫£n ·ª©ng c·ªßa ng∆∞·ªùi d√πng v·ªõi qu·∫£ng c√°o ‚Äî h·ªç kh√¥ng truy c·∫≠p ngay l·∫≠p t·ª©c m√† th∆∞·ªùng c·∫ßn v√†i ng√†y ƒë·ªÉ ph·∫£n h·ªìi, t√πy v√†o ng·ªØ c·∫£nh v√† n·ªôi dung qu·∫£ng b√°.    

#### *Step 4: D·ª± b√°o s·ªë l∆∞·ª£t xem trang (page views):*  

D·ª±a tr√™n c√°c bi·ªÉu ƒë·ªì ACF v√† PACF c·ªßa chu·ªói `page_views` ·ªü ph·∫ßn tr∆∞·ªõc, ta ti·∫øn h√†nh ph√¢n t√≠ch ƒë·ªÉ x√°c ƒë·ªãnh c√°c th√†nh ph·∫ßn c·ªßa m√¥ h√¨nh SARIMA nh∆∞ sau:    

1. **Th√†nh ph·∫ßn kh√¥ng m√πa v·ª• (Non-seasonal):**   

K√Ω hi·ªáu: $(p, d, q)$    

* **d = 0**: Do chu·ªói ƒë√£ ƒë∆∞·ª£c ki·ªÉm tra l√† d·ª´ng, n√™n kh√¥ng c·∫ßn sai ph√¢n th∆∞·ªùng.   
* **p = 2**: Bi·ªÉu ƒë·ªì PACF cho th·∫•y h·ªá s·ªë t∆∞∆°ng quan ri√™ng ph·∫ßn gi·∫£m m·∫°nh v√† c·∫Øt c·ª•t r√µ r√†ng sau ƒë·ªô tr·ªÖ 2, n√™n ch·ªçn b·∫≠c AR l√† 2.   
* **q = 1 ho·∫∑c 2**: Bi·ªÉu ƒë·ªì ACF suy gi·∫£m d·∫ßn theo d·∫°ng h√†m m≈©, kh√¥ng c·∫Øt c·ª•t r√µ r√†ng, g·ª£i √Ω s·ª± hi·ªán di·ªán c·ªßa th√†nh ph·∫ßn MA ‚Äî ƒë·ªÅ xu·∫•t th·ª≠ q = 1 ho·∫∑c 2.     

2. **Th√†nh ph·∫ßn m√πa v·ª• (Seasonal):**    

K√Ω hi·ªáu: $(P, D, Q)_s$    

* **s = 7**: Bi·ªÉu ƒë·ªì ACF cho th·∫•y r√µ r√†ng c√°c ƒë·ªânh l·∫∑p l·∫°i t·∫°i c√°c ƒë·ªô tr·ªÖ l√† b·ªôi s·ªë c·ªßa 7 (lag = 7, 14, 21...), ph·∫£n √°nh chu k·ª≥ m√πa v·ª• theo tu·∫ßn.    
* **D = 1**: Chu·ªói v·∫´n c√≤n xu h∆∞·ªõng m√πa v·ª• n√™n c·∫ßn sai ph√¢n m√πa v·ª• c·∫•p 1 ƒë·ªÉ l√†m ·ªïn ƒë·ªãnh.    
* **P = 1, Q = 1**: Bi·ªÉu ƒë·ªì ACF v√† PACF ƒë·ªÅu c√≥ spike ƒë√°ng k·ªÉ t·∫°i lag = 7 $\rightarrow$ cho th·∫•y n√™n ƒë∆∞a v√†o c·∫£ th√†nh ph·∫ßn AR v√† MA m√πa v·ª•.   

3. **ƒê·ªÅ xu·∫•t m√¥ h√¨nh:**    

$$
\text{SARIMA}(2, 0, 1) \times (1, 1, 1)_7 \quad \text{ho·∫∑c} \quad \text{SARIMA}(2, 0, 2) \times (1, 1, 1)_7
$$

Hai m√¥ h√¨nh n√†y ƒë·ªÅu ph√π h·ª£p v·ªõi ƒë·∫∑c tr∆∞ng chu·ªói v√† c·∫ßn ƒë∆∞·ª£c so s√°nh th√™m b·∫±ng c√°c ti√™u ch√≠ AIC, BIC v√† ki·ªÉm ƒë·ªãnh ph·∫ßn d∆∞ ƒë·ªÉ ch·ªçn m√¥ h√¨nh t·ªëi ∆∞u nh·∫•t.       

##### **∆Ø·ªõc l∆∞·ª£ng m√¥ h√¨nh ARIMA (kh√¥ng c√≥ m√πa v·ª•):**     

Trong ph√¢n t√≠ch chu·ªói th·ªùi gian, m√¥ h√¨nh ARIMA (AutoRegressive Integrated Moving Average) l√† m·ªôt trong nh·ªØng ph∆∞∆°ng ph√°p ph·ªï bi·∫øn nh·∫•t ƒë·ªÉ d·ª± b√°o chu·ªói c√≥ t√≠nh ·ªïn ƒë·ªãnh sau sai ph√¢n. Tr∆∞·ªõc ti√™n, ch√∫ng t√¥i th·ª≠ nghi·ªám m√¥ h√¨nh ARIMA kh√¥ng c√≥ th√†nh ph·∫ßn m√πa v·ª• nh·∫±m ki·ªÉm tra xem xu h∆∞·ªõng v√† nhi·ªÖu ng·∫´u nhi√™n c√≥ th·ªÉ ƒë∆∞·ª£c m√¥ t·∫£ t·ªët m√† kh√¥ng c·∫ßn t√≠nh ƒë·∫øn chu k·ª≥ hay kh√¥ng.   

```{r}
# T√¨m m√¥ h√¨nh ARIMA t·ªët nh·∫•t (kh√¥ng t√≠nh m√πa v·ª•)
best_arima <- auto.arima(ts_page_views_1, seasonal = FALSE, stepwise = FALSE, approximation = FALSE)
summary(best_arima)
```

ƒê·∫ßu ti√™n, ch√∫ng t√¥i th·ª≠ ∆∞·ªõc l∆∞·ª£ng m√¥ h√¨nh ARIMA kh√¥ng m√πa v·ª•. M√¥ h√¨nh ƒë∆∞·ª£c l·ª±a ch·ªçn l√† ARIMA(4,1,1) with drift, tuy nhi√™n c√°c ti√™u ch√≠ ƒë√°nh gi√° nh∆∞ AIC (13360.54) v√† RMSE (107.03) cho th·∫•y m√¥ h√¨nh ch∆∞a th·∫≠t s·ª± t·ªëi ∆∞u.    
 

##### **∆Ø·ªõc l∆∞·ª£ng m√¥ h√¨nh SARIMA (c√≥ y·∫øu t·ªë m√πa v·ª•):**   
```{r}
# D√≤ t√¨m m√¥ h√¨nh SARIMA t·ª± ƒë·ªông c√≥ m√πa v·ª•
model_sarima <- auto.arima(ts_page_views,
                           seasonal = TRUE,
                           stepwise = FALSE,
                           approximation = FALSE)

# Hi·ªÉn th·ªã k·∫øt qu·∫£
summary(model_sarima)

```

Ti·∫øp theo, khi ƒë∆∞a y·∫øu t·ªë m√πa v·ª• v√†o m√¥ h√¨nh b·∫±ng `auto.arima()` v·ªõi `seasonal = TRUE`, m√¥ h√¨nh $\text{SARIMA}(4,0,0)\times(0,1,1)_7$ ƒë∆∞·ª£c ch·ªçn v·ªõi AIC = 13015.95, RMSE = 94.03 v√† MAPE ‚âà 4.91% (r·∫•t t·ªët v√¨ th∆∞·ªùng <10% ƒë∆∞·ª£c xem l√† m√¥ h√¨nh d·ª± b√°o t·ªët). ƒêi·ªÅu n√†y ch·ª©ng minh r·∫±ng y·∫øu t·ªë m√πa v·ª• theo tu·∫ßn c√≥ √Ω nghƒ©a v√† gi√∫p m√¥ h√¨nh d·ª± b√°o t·ªët h∆°n.    

M√¥ h√¨nh ARIMA truy·ªÅn th·ªëng ch·ªâ ph√π h·ª£p v·ªõi c√°c chu·ªói th·ªùi gian kh√¥ng c√≥ t√≠nh m√πa v·ª• r√µ r√†ng. Trong khi ƒë√≥, SARIMA cho ph√©p m√¥ h√¨nh h√≥a c√°c chu·ªói c√≥ h√†nh vi l·∫∑p l·∫°i theo chu k·ª≥, nh∆∞ l∆∞·ª£t truy c·∫≠p theo tu·∫ßn, th√°ng,... Vi·ªác th√™m th√†nh ph·∫ßn m√πa v·ª• gi√∫p tƒÉng ƒë·ªô ch√≠nh x√°c khi c√°c ƒë·∫∑c ƒëi·ªÉm chu k·ª≥ l√† n·ªïi b·∫≠t v√† l·∫∑p l·∫°i ·ªïn ƒë·ªãnh.     


```{r}
# Hi·ªÉn th·ªã ph·∫ßn d∆∞
checkresiduals(model_sarima)
```

Sau khi ∆∞·ªõc l∆∞·ª£ng m√¥ h√¨nh $\text{SARIMA}(4,0,0)\times(0,1,1)_7$, ph·∫ßn d∆∞ c·ªßa m√¥ h√¨nh ƒë∆∞·ª£c ki·ªÉm tra b·∫±ng h√†m `checkresiduals()`.
K·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh Ljung‚ÄìBox cho th·∫•y:    
$$
Q^* = 29.36,\quad df = 9,\quad p\text{-value} = 0.00056
$$
V√¨ $p-value < 0.01$, ta b√°c b·ªè gi·∫£ thuy·∫øt $H_0$ r·∫±ng ph·∫ßn d∆∞ l√† nhi·ªÖu tr·∫Øng.    
Ngo√†i ra:    
 
**1. Bi·ªÉu ƒë·ªì th·ªùi gian ph·∫ßn d∆∞ (top panel)**   

* D√£y ph·∫ßn d∆∞ dao ƒë·ªông quanh gi√° tr·ªã trung b√¨nh 0, kh√¥ng c√≥ xu h∆∞·ªõng r√µ r·ªát, cho th·∫•y ƒë√£ lo·∫°i b·ªè ƒë∆∞·ª£c xu h∆∞·ªõng tuy·∫øn t√≠nh kh·ªèi d·ªØ li·ªáu g·ªëc.   
* Tuy nhi√™n, bi√™n ƒë·ªô dao ƒë·ªông t∆∞∆°ng ƒë·ªëi l·ªõn, v√† xu·∫•t hi·ªán m·ªôt s·ªë ƒëi·ªÉm nhi·ªÖu m·∫°nh.    

**2. Bi·ªÉu ƒë·ªì ACF c·ªßa ph·∫ßn d∆∞ (bottom-left panel)**     

* M·ªôt s·ªë gi√° tr·ªã ACF n·∫±m ngo√†i kho·∫£ng tin c·∫≠y (ƒë∆∞·ªùng xanh), cho th·∫•y ph·∫ßn d∆∞ v·∫´n c√≤n t·ª± t∆∞∆°ng quan.   
* ƒêi·ªÅu n√†y x√°c nh·∫≠n l·∫°i k·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh Ljung‚ÄìBox tr∆∞·ªõc ƒë√≥ (p-value = 0.00056), r·∫±ng ph·∫ßn d∆∞ kh√¥ng ho√†n to√†n l√† white noise.   

**3. Bi·ªÉu ƒë·ªì histogram v√† m·∫≠t ƒë·ªô ph·∫ßn d∆∞ (bottom-right panel)**   

* D·∫°ng ph√¢n ph·ªëi ph·∫ßn d∆∞ kh√° gi·ªëng chu·∫©n, nh∆∞ng v·∫´n c√≤n hi·ªán t∆∞·ª£ng l·ªách nh·∫π.    

T·∫•t c·∫£ c√°c ƒëi·ªÅu tr√™n cho th·∫•y m√¥ h√¨nh SARIMA hi·ªán t·∫°i ch∆∞a m√¥ t·∫£ h·∫øt c·∫•u tr√∫c chu·ªói th·ªùi gian, v√† c√≥ th·ªÉ c·∫ßn ƒëi·ªÅu ch·ªânh th√™m ƒë·ªÉ c·∫£i thi·ªán.    

##### **Th·ª≠ nghi·ªám m√¥ h√¨nh SARIMAX v·ªõi bi·∫øn ngo·∫°i sinh:**    

M·ª•c ti√™u: Ki·ªÉm tra xem c√°c y·∫øu t·ªë ngo√†i chu·ªói th·ªùi gian nh∆∞ chi ti√™u qu·∫£ng c√°o (`ad_spend`), ng√†y cu·ªëi tu·∫ßn (`is_weekend`) v√† ng√†y l·ªÖ (`is_holiday`) c√≥ gi√∫p c·∫£i thi·ªán ƒë·ªô ch√≠nh x√°c d·ª± b√°o hay kh√¥ng.     

```{r}
# M√¥ h√¨nh c√≥ y·∫øu t·ªë ngo·∫°i sinh nh∆∞ chi ph√≠ qu·∫£ng c√°o, ng√†y ngh·ªâ
ad_spend_scaled <- scale(web_data$ad_spend)   
xreg_std <- cbind(
  ad_spend_scaled,
  web_data$is_weekend_num,
  web_data$is_holiday_num
)

model_sarimax <- auto.arima(ts_page_views, xreg = xreg_std,
                         seasonal = TRUE,
                         stepwise = FALSE, approximation = FALSE)

summary(model_sarimax)
```

Nh·∫≠n x√©t:   

* M·∫∑c d√π m√¥ h√¨nh SARIMAX v·ªõi bi·∫øn ngo·∫°i sinh (ad_spend, is_weekend, is_holiday) ƒë∆∞·ª£c th·ª≠ nghi·ªám nh·∫±m c·∫£i thi·ªán ƒë·ªô ch√≠nh x√°c d·ª± b√°o, k·∫øt qu·∫£ cho th·∫•y m√¥ h√¨nh n√†y c√≥ AIC = 13297.77 v√† RMSE = 103.68, ƒë·ªÅu cao h∆°n so v·ªõi m√¥ h√¨nh SARIMA ƒë√£ ch·ªçn tr∆∞·ªõc ƒë√≥ (AIC = 13015.95, RMSE = 94.03).    
* Vi·ªác m√¥ h√¨nh SARIMAX kh√¥ng mang l·∫°i c·∫£i thi·ªán ƒë√°ng k·ªÉ cho th·∫•y c√°c bi·∫øn ngo·∫°i sinh c√≥ th·ªÉ ƒë√£ ƒë∆∞·ª£c m√¥ h√¨nh h√≥a gi√°n ti·∫øp qua th√†nh ph·∫ßn m√πa v·ª• (weekly seasonality). Ngo√†i ra, ·∫£nh h∆∞·ªüng c·ªßa bi·∫øn ngo·∫°i sinh c√≥ th·ªÉ l√† phi tuy·∫øn, ƒëi·ªÅu m√† m√¥ h√¨nh ARIMA kh√¥ng th·ªÉ n·∫Øm b·∫Øt ƒë∆∞·ª£c.      
* Do ƒë√≥, ch√∫ng t√¥i quy·∫øt ƒë·ªãnh kh√¥ng s·ª≠ d·ª•ng SARIMAX, thay v√†o ƒë√≥ ch√∫ng t√¥i s·∫Ω ti·∫øp t·ª•c ki·ªÉm tra v·ªõi m√¥ h√¨nh SARIMA th·ªß c√¥ng th√¥ng qua bi·ªÉu ƒë·ªì ACF v√† PACF.           

##### **M√¥ h√¨nh SARIMA th·ªß c√¥ng t·ª´ ACF v√† PCF:**      
    
```{r}
# M√¥ h√¨nh t·ª´ auto.arima:
model_base <- Arima(ts_page_views, order = c(4, 0, 0),
                    seasonal = list(order = c(0, 1, 1), period = 7))

# M√¥ h√¨nh t·ª´ ACF v√† PACF:
model_alt1 <- Arima(ts_page_views, order = c(2, 0, 1),
                    seasonal = list(order = c(1, 1, 1), period = 7))

model_alt2 <- Arima(ts_page_views, order = c(2, 0, 2),
                    seasonal = list(order = c(1, 1, 1), period = 7))
# M√¥ h√¨nh th·ª≠ nghi·ªám khi n√¢ng b·∫≠c AR cao h∆°n m√¥ h√¨nh ∆∞·ªõc l∆∞·ª£ng t·ª´ auto.arima
model_alt3 <- Arima(ts_page_views, order = c(5, 0, 1),
                    seasonal = list(order = c(1, 1, 1), period = 7))

model_alt4 <- Arima(ts_page_views, order = c(5, 0, 2),
                    seasonal = list(order = c(1, 1, 1), period = 7))

```

**So s√°nh c√°c ch·ªâ s·ªë:**      

```{r}
model_list <- list(
  SARIMA_400_011 = model_base,
  SARIMAX = model_sarimax,
  SARIMA_201_111 = model_alt1,
  SARIMA_202_111 = model_alt2,
  SARIMA_501_111 = model_alt3,
  SARIMA_502_111 = model_alt4
)

get_AICc <- function(model) {
  n <- length(model$x)
  k <- length(model$coef)
  aic <- AIC(model)
  aicc <- aic + (2 * k * (k + 1)) / (n - k - 1)
  return(aicc)
}

get_RMSE <- function(model) {
  return(forecast::accuracy(model)[1, "RMSE"])
}

get_MAPE <- function(model) {
  return(forecast::accuracy(model)[1, "MAPE"])
}


model_metrics <- data.frame(
  Model = names(model_list),
  AIC = sapply(model_list, AIC),
  AICc = sapply(model_list, get_AICc),
  BIC = sapply(model_list, BIC),
  RMSE = sapply(model_list, get_RMSE),
  MAPE = sapply(model_list, get_MAPE)
)

print(model_metrics)
```

**Ki·ªÉm tra ph·∫ßn d∆∞ (ACF, histogram, Ljung‚ÄìBox):**
```{r}
checkresiduals(model_base)
checkresiduals(model_sarimax)
checkresiduals(model_alt1)
checkresiduals(model_alt2)
checkresiduals(model_alt3)
checkresiduals(model_alt4)
```

K·∫øt lu·∫≠n:    

* C√°c m√¥ h√¨nh SARIMA t·ª´ h√†m auto.arima v√† SARIMAX ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t v√† m√¥ h√¨nh t·ª´ bi·ªÉu ƒë·ªì ACF, PACF ch∆∞a m√¥ t·∫£ h·∫øt c·∫•u tr√∫c chu·ªói th·ªùi gian. Ph·∫ßn d∆∞ v·∫´n c√≤n th√¥ng tin, th·ªÉ hi·ªán qua: (1) ACF ph·∫ßn d∆∞ c√≤n v∆∞·ª£t ng∆∞·ª°ng, (2) Ki·ªÉm ƒë·ªãnh Ljung‚ÄìBox cho p-value < 0.05.     
* V·ªÅ c√°c m√¥ h√¨nh $\text{SARIMA}(5,0,1) \times (1,1,1)_7$ v√† $\text{SARIMA}(5,0,2) \times (1,1,1)_7$:         
    + **Ph√¢n ph·ªëi ph·∫ßn d∆∞:** Histogram ph·∫ßn d∆∞ c·ªßa c·∫£ hai m√¥ h√¨nh ƒë·ªÅu c√≥ h√¨nh d·∫°ng g·∫ßn gi·ªëng ph√¢n ph·ªëi chu·∫©n, v·ªõi ƒë∆∞·ªùng cong m·∫≠t ƒë·ªô (ƒë·ªè) b√°m s√°t histogram ‚Äî ƒë√¢y l√† d·∫•u hi·ªáu t·ªët cho gi·∫£ ƒë·ªãnh ph√¢n ph·ªëi chu·∫©n c·ªßa sai s·ªë.    
    + **T·ª± t∆∞∆°ng quan ph·∫ßn d∆∞ (ACF):**C√°c bi·ªÉu ƒë·ªì ACF c·ªßa ph·∫ßn d∆∞ ƒë·ªÅu cho th·∫•y h·∫ßu h·∫øt c√°c gi√° tr·ªã n·∫±m trong kho·∫£ng tin c·∫≠y 95%, kh√¥ng c√≥ b·∫±ng ch·ª©ng r√µ r√†ng v·ªÅ hi·ªán t∆∞·ª£ng t·ª± t∆∞∆°ng quan c√≤n s√≥t l·∫°i. ƒêi·ªÅu n√†y cho th·∫•y ph·∫ßn d∆∞ kh√¥ng c√≤n mang th√¥ng tin c√≥ th·ªÉ khai th√°c, ƒë√°p ·ª©ng gi·∫£ ƒë·ªãnh white noise.    
    + **Ki·ªÉm ƒë·ªãnh Ljung-Box:** M√¥ h√¨nh $\text{SARIMA}(5,0,1) \times (1,1,1)_7$ (p-value = 0.6538) v√†  $\text{SARIMA}(5,0,2) \times (1,1,1)_7$ (p-value = 0.7187) ƒë·ªÅu l·ªõn h∆°n 0.05 n√™n ta kh√¥ng ƒë·ªß c∆° s·ªü b√°c b·ªè gi·∫£ thuy·∫øt $H_0$ (ph·∫ßn d∆∞ l√† white noise), do ƒë√≥ kh√¥ng c√≥ b·∫±ng ch·ª©ng v·ªÅ hi·ªán t∆∞·ª£ng t·ª± t∆∞∆°ng quan c√≤n l·∫°i trong ph·∫ßn d∆∞.    

##### **L·ª±a ch·ªçn m√¥ h√¨nh SARIMA t·ªët nh·∫•t ƒë·ªÉ d·ª± b√°o:**   

Sau khi th·ª≠ nhi·ªÅu m√¥ h√¨nh SARIMA v·ªõi c√°c c·∫•u h√¨nh kh√°c nhau v·ªÅ b·∫≠c ARIMA v√† th√†nh ph·∫ßn m√πa v·ª•, m√¥ h√¨nh ƒë∆∞·ª£c l·ª±a ch·ªçn l√†:    

$$
\text{SARIMA}(5,0,2)\times(1,1,1)_7
$$

**L√Ω do l·ª±a ch·ªçn:**   

* ƒê√¢y l√† m·ªôt trong hai m√¥ h√¨nh c√≥ AIC, BIC, AICc, RMSE v√† MAPE th·∫•p nh·∫•t, cho th·∫•y hi·ªáu nƒÉng d·ª± b√°o v∆∞·ª£t tr·ªôi.    
* S·ªë l∆∞·ª£ng tham s·ªë l·ªõn h∆°n gi√∫p m√¥ h√¨nh linh ho·∫°t h∆°n trong vi·ªác m√¥ t·∫£ c√°c ƒë·∫∑c tr∆∞ng c·ªßa chu·ªói.    
* Ki·ªÉm ƒë·ªãnh Ljung‚ÄìBox cho th·∫•y p-value cao h∆°n, t·ª©c ph·∫ßn d∆∞ c√≥ t√≠nh ch·∫•t white noise t·ªët h∆°n.   
* Ph√¢n ph·ªëi ph·∫ßn d∆∞ g·∫ßn chu·∫©n h∆°n, ƒë·∫£m b·∫£o gi·∫£ ƒë·ªãnh th·ªëng k√™ v·ªÅ sai s·ªë ƒë∆∞·ª£c ƒë√°p ·ª©ng.    

##### **Ki·ªÉm tra overfitting cho m√¥ h√¨nh d·ª± b√°o:**   

ƒê·ªÉ ƒë√°nh gi√° kh·∫£ nƒÉng t·ªïng qu√°t h√≥a c·ªßa m√¥ h√¨nh v√† ki·ªÉm tra hi·ªán t∆∞·ª£ng overfitting (qu√° kh·ªõp), ch√∫ng t√¥i ti·∫øn h√†nh chia d·ªØ li·ªáu th√†nh hai ph·∫ßn:   

* T·∫≠p hu·∫•n luy·ªán (training set): to√†n b·ªô chu·ªói tr·ª´ 15 ng√†y cu·ªëi.    
* T·∫≠p ki·ªÉm ƒë·ªãnh (test set): 15 ng√†y cu·ªëi c√πng.    

```{r}
# Chia d·ªØ li·ªáu: gi·ªØ l·∫°i 15 ng√†y cu·ªëi l√†m test
train_ts <- window(ts_page_views, end = c(156, 7))  # D·ªØ li·ªáu c√≥ t·∫ßn su·∫•t h√†ng ng√†y v√† tu·∫ßn th·ª© 156 l√† tu·∫ßn g·∫ßn cu·ªëi
test_ts  <- window(ts_page_views, start = c(157, 1))

# Hu·∫•n luy·ªán m√¥ h√¨nh SARIMA(5,0,2)(1,1,1)[7] tr√™n t·∫≠p train
fit_train <- Arima(train_ts, order = c(5,0,2),
                   seasonal = list(order = c(1,1,1), period = 7))

# D·ª± b√°o 15 b∆∞·ªõc t∆∞∆°ng lai (b·∫±ng ƒë·ªô d√†i c·ªßa test)
n_test <- length(test_ts)
fc_test <- forecast(fit_train, h = n_test)

# Hi·ªÉn th·ªã bi·ªÉu ƒë·ªì d·ª± b√°o v√† d·ªØ li·ªáu th·ª±c t·∫ø
autoplot(fc_test) + autolayer(test_ts, series = "Test data")


# Sai s·ªë tr√™n t·∫≠p ki·ªÉm ƒë·ªãnh
rmse_test <- rmse(actual = test_ts, predicted = fc_test$mean)
mape_test <- mape(actual = test_ts, predicted = fc_test$mean)

cat("RMSE (Test):", rmse_test, "\n")
cat("MAPE (Test):", mape_test, "\n")


# D·ª± b√°o fitted values t·ª´ m√¥ h√¨nh hu·∫•n luy·ªán
fitted_values <- fitted(fit_train)

# Sai s·ªë th·ªß c√¥ng
rmse_train <- sqrt(mean((train_ts - fitted_values)^2))
mape_train <- mean(abs((train_ts - fitted_values)/train_ts)) * 100

cat("RMSE (Train):", rmse_train, "\n")
cat("MAPE (Train):", mape_train, "\n")


```

M√¥ h√¨nh $\text{SARIMA}(5,0,2)\times(1,1,1)_7$ ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n t·∫≠p hu·∫•n luy·ªán v√† sau ƒë√≥ d·ª± b√°o 15 b∆∞·ªõc ti·∫øp theo. K·∫øt qu·∫£ sai s·ªë nh∆∞ sau:   

|                    | RMSE  | MAPE (%) |
| ------------------ | ----- | -------- |
| **T·∫≠p hu·∫•n luy·ªán** | 89.39 | 4.72     |
| **T·∫≠p ki·ªÉm ƒë·ªãnh**  | 90.69 | 3.21     |

* RMSE c·ªßa t·∫≠p ki·ªÉm ƒë·ªãnh (90.69) ch·ªâ nh·ªânh h∆°n nh·∫π so v·ªõi hu·∫•n luy·ªán (89.39) $\rightarrow$ cho th·∫•y m√¥ h√¨nh d·ª± b√°o ·ªïn ƒë·ªãnh v√† kh√¥ng c√≥ d·∫•u hi·ªáu overfit.   
* MAPE c·ªßa t·∫≠p ki·ªÉm ƒë·ªãnh (3.21%) c√≤n th·∫•p h∆°n hu·∫•n luy·ªán (4.72%), cho th·∫•y m√¥ h√¨nh ho·∫°t ƒë·ªông r·∫•t t·ªët tr√™n d·ªØ li·ªáu, tƒÉng ƒë·ªô tin c·∫≠y cho c√°c d·ª± b√°o t∆∞∆°ng lai.    

Do ƒë√≥, c√≥ th·ªÉ k·∫øt lu·∫≠n r·∫±ng m√¥ h√¨nh ƒë√£ h·ªçc ƒë∆∞·ª£c c·∫•u tr√∫c chu·ªói m·ªôt c√°ch hi·ªáu qu·∫£ v√† c√≥ kh·∫£ nƒÉng t·ªïng qu√°t h√≥a t·ªët m√† kh√¥ng b·ªã qu√° kh·ªõp d·ªØ li·ªáu qu√° kh·ª©.    

##### **D·ª± b√°o 15 ng√†y ti·∫øp theo:**   
```{r}
sarima_result_15 <- sarima.for(ts_page_views, n.ahead = 15,
           p = 5, d = 0, q = 2,
           P = 1, D = 1, Q = 1, S = 7)
sarima_result_15

# D·ª± b√°o v√† sai s·ªë chu·∫©n
pred <- as.numeric(sarima_result_15$pred)  
se <- as.numeric(sarima_result_15$se)      

# T√≠nh lower v√† upper bounds
lower <- pred - 1.96 * se
upper <- pred + 1.96 * se

ci_table <- data.frame(
  Day = 1:length(pred),
  Forecast = pred,
  SE = se,
  CI_Lower = lower,
  CI_Upper = upper
)

print(ci_table)
```

D·∫£i tin c·∫≠y 95% ƒë∆∞·ª£c t√≠nh d·ª±a tr√™n c√¥ng th·ª©c:    

$$
\text{CI}_{\text{Lower}} = \hat{y}_t - 1.96 \cdot SE_t, \quad \text{CI}_{\text{Upper}} = \hat{y}_t + 1.96 \cdot SE_t
$$

Trong ƒë√≥:   

* $\hat{y}_t$: Gi√° tr·ªã d·ª± b√°o t·∫°i th·ªùi ƒëi·ªÉm t.   
* $SE_t$: Sai s·ªë chu·∫©n c·ªßa d·ª± b√°o t·∫°i th·ªùi ƒëi·ªÉm t.    
* $1.96$: H·ªá s·ªë ·ª©ng v·ªõi m·ª©c tin c·∫≠y 95% trong ph√¢n ph·ªëi chu·∫©n.     

D·ª± b√°o ƒë∆∞·ª£c th·ª±c hi·ªán cho 15 ng√†y ti·∫øp theo b·∫±ng m√¥ h√¨nh $\text{SARIMA}(5,0,2)\times(1,1,1)_7$ ƒë√£ cho th·∫•y k·∫øt qu·∫£ h·ª£p l√Ω v√† ƒë√°ng tin c·∫≠y.    

1. **T√≠nh m√πa v·ª• ƒë∆∞·ª£c m√¥ h√¨nh h√≥a r√µ r√†ng**

Chu·ªói gi√° tr·ªã d·ª± b√°o th·ªÉ hi·ªán ƒë·∫∑c tr∆∞ng chu k·ª≥ 7 ng√†y r√µ n√©t, v·ªõi c√°c ƒë·ªânh v√† ƒë√°y l·∫∑p l·∫°i ƒë·ªÅu ƒë·∫∑n, ph·∫£n √°nh t√≠nh m√πa v·ª• theo tu·∫ßn trong h√†nh vi truy c·∫≠p trang:   

* Gi√° tr·ªã d·ª± b√°o dao ƒë·ªông t·ª´ 1788 ƒë·∫øn 2175, ph√π h·ª£p v·ªõi bi√™n ƒë·ªô quan s√°t th·ª±c t·∫ø tr∆∞·ªõc ƒë√≥.   
* Nh·ªãp ƒëi·ªáu tƒÉng ‚Äì gi·∫£m theo tu·∫ßn ƒë∆∞·ª£c duy tr√¨, cho th·∫•y m√¥ h√¨nh ƒë√£ h·ªçc t·ªët c·∫•u tr√∫c chu·ªói.    

2. **Sai s·ªë chu·∫©n ·ªïn ƒë·ªãnh v√† h·ª£p l√Ω**     

Sai s·ªë chu·∫©n (`$se`) tƒÉng nh·∫π t·ª´ kho·∫£ng 89.4 ƒë·∫øn 97.2 trong su·ªët 15 b∆∞·ªõc d·ª± b√°o. ƒêi·ªÅu n√†y cho th·∫•y:   

* M·ª©c ƒë·ªô kh√¥ng ch·∫Øc ch·∫Øn ch·ªâ tƒÉng nh·∫π khi ti·∫øn xa h∆°n v√†o t∆∞∆°ng lai.   
* M√¥ h√¨nh ·ªïn ƒë·ªãnh v√† kh√¥ng c√≥ d·∫•u hi·ªáu nhi·ªÖu lo·∫°n ho·∫∑c "m·ªü r·ªông b·∫•t ƒë·ªãnh" theo th·ªùi gian nh∆∞ c√°c m√¥ h√¨nh k√©m ch·∫•t l∆∞·ª£ng.   

3. **Kho·∫£ng tin c·∫≠y 95% ph·∫£n √°nh r√µ t√≠nh chu k·ª≥ c·ªßa b·∫•t ƒë·ªãnh**   

Kho·∫£ng tin c·∫≠y ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·∫±ng v√πng x√°m trong bi·ªÉu ƒë·ªì c√≥ ƒë·∫∑c ƒëi·ªÉm ƒë·∫∑c bi·ªát:   

* Kh√¥ng m·ªü r·ªông ƒë·ªÅu, m√† dao ƒë·ªông theo chu k·ª≥: r·ªông h∆°n t·∫°i c√°c ƒëi·ªÉm ƒë·ªânh v√† ƒë√°y c·ªßa chu·ªói d·ª± b√°o.   
* ƒêi·ªÅu n√†y cho th·∫•y t·∫°i c√°c th·ªùi ƒëi·ªÉm bi·∫øn ƒë·ªông m·∫°nh (c·ª±c ƒë·∫°i v√† c·ª±c ti·ªÉu), ƒë·ªô kh√¥ng ch·∫Øc ch·∫Øn c·ªßa m√¥ h√¨nh tƒÉng l√™n ‚Äî m·ªôt hi·ªán t∆∞·ª£ng h·ª£p l√Ω trong th·ª±c ti·ªÖn, v√¨ nh·ªØng thay ƒë·ªïi nhanh th∆∞·ªùng kh√≥ d·ª± b√°o ch√≠nh x√°c h∆°n.     
* Ng∆∞·ª£c l·∫°i, t·∫°i c√°c ƒëi·ªÉm g·∫ßn trung b√¨nh ho·∫∑c ·ªïn ƒë·ªãnh, v√πng tin c·∫≠y h·∫πp h∆°n, ph·∫£n √°nh m·ª©c ƒë·ªô d·ª± b√°o ch·∫Øc ch·∫Øn h∆°n.    

##### **D·ª± b√°o 30 ng√†y ti·∫øp theo:**   
```{r}
sarima_result_30 <- sarima.for(ts_page_views, n.ahead = 30,
           p = 5, d = 0, q = 2,
           P = 1, D = 1, Q = 1, S = 7)
sarima_result_30

# D·ª± b√°o v√† sai s·ªë chu·∫©n
pred <- as.numeric(sarima_result_30$pred)  
se <- as.numeric(sarima_result_30$se)      

# T√≠nh lower v√† upper bounds
lower <- pred - 1.96 * se
upper <- pred + 1.96 * se

ci_table <- data.frame(
  Day = 1:length(pred),
  Forecast = pred,
  SE = se,
  CI_Lower = lower,
  CI_Upper = upper
)

print(ci_table)
```

D·ª± b√°o ƒë∆∞·ª£c th·ª±c hi·ªán cho 30 ng√†y ti·∫øp theo b·∫±ng m√¥ h√¨nh $\text{SARIMA}(5,0,2) \times(1,1,1)_7$ ƒë√£ cho th·∫•y k·∫øt qu·∫£ h·ª£p l√Ω v√† c√≥ ƒë·ªô tin c·∫≠y cao.   

1. **T√≠nh m√πa v·ª• ƒë∆∞·ª£c m√¥ h√¨nh h√≥a r√µ r√†ng**    

Chu·ªói gi√° tr·ªã d·ª± b√°o ti·∫øp t·ª•c th·ªÉ hi·ªán t√≠nh chu k·ª≥ 7 ng√†y ƒë·ªÅu ƒë·∫∑n, v·ªõi c√°c ƒë·ªânh v√† ƒë√°y l·∫∑p l·∫°i ƒë√∫ng nh·ªãp tu·∫ßn:   

* Gi√° tr·ªã d·ª± b√°o dao ƒë·ªông trong kho·∫£ng t·ª´ kho·∫£ng 1790 ƒë·∫øn 2183, ph√π h·ª£p v·ªõi bi√™n ƒë·ªô bi·∫øn thi√™n ƒë√£ quan s√°t trong chu·ªói d·ªØ li·ªáu g·ªëc.   
* M√¥ h√¨nh ƒë√£ h·ªçc v√† t√°i hi·ªán ƒë∆∞·ª£c nh·ªãp ƒëi·ªáu m√πa v·ª• m·ªôt c√°ch ch√≠nh x√°c ‚Äî c√°c giai ƒëo·∫°n tƒÉng v√† gi·∫£m theo tu·∫ßn v·∫´n ƒë∆∞·ª£c duy tr√¨ nh·∫•t qu√°n.   

2. **Sai s·ªë chu·∫©n tƒÉng nh·∫π, ·ªïn ƒë·ªãnh v√† h·ª£p l√Ω**   

Sai s·ªë chu·∫©n (`$se`) tƒÉng t·ª´ 89.4 ƒë·∫øn 101.3 qua 30 b∆∞·ªõc d·ª± b√°o, v·ªõi xu h∆∞·ªõng tƒÉng d·∫ßn r·∫•t m∆∞·ª£t:   

* ƒêi·ªÅu n√†y l√† ƒë·∫∑c tr∆∞ng c·ªßa c√°c m√¥ h√¨nh chu·ªói th·ªùi gian t·ªët, khi sai s·ªë ch·ªâ tƒÉng d·∫ßn nh·∫π do d·ª± b√°o xa h∆°n.   
* M·ª©c tƒÉng sai s·ªë l√† h·ª£p l√Ω, kh√¥ng ƒë·ªôt ng·ªôt, ch·ª©ng t·ªè m√¥ h√¨nh ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh v√† kh√¥ng g·∫∑p v·∫•n ƒë·ªÅ nhi·ªÖu ho·∫∑c ph√¨nh sai s·ªë.   

3. **Kho·∫£ng tin c·∫≠y 95% ph·∫£n √°nh r√µ t√≠nh chu k·ª≥ c·ªßa b·∫•t ƒë·ªãnh**   

V√πng x√°m bi·ªÉu di·ªÖn kho·∫£ng tin c·∫≠y 95% trong bi·ªÉu ƒë·ªì th·ªÉ hi·ªán s·ª± thay ƒë·ªïi kh√¥ng ƒë·ªÅu, mang t√≠nh chu k·ª≥ r√µ r√†ng:   

* T·∫°i c√°c ƒë·ªânh v√† ƒë√°y c·ªßa chu·ªói d·ª± b√°o, kho·∫£ng tin c·∫≠y r·ªông h∆°n ‚Äî ƒëi·ªÅu n√†y ph·∫£n √°nh m·ª©c ƒë·ªô b·∫•t ƒë·ªãnh cao h∆°n khi m√¥ h√¨nh d·ª± b√°o c√°c ƒëi·ªÉm bi·∫øn ƒë·ªông m·∫°nh.    
* T·∫°i c√°c ƒëi·ªÉm g·∫ßn trung b√¨nh chu k·ª≥, v√πng tin c·∫≠y h·∫πp l·∫°i ‚Äî th·ªÉ hi·ªán m·ª©c ƒë·ªô ch·∫Øc ch·∫Øn cao h∆°n ·ªü c√°c th·ªùi ƒëi·ªÉm ·ªïn ƒë·ªãnh.    

ƒê√¢y l√† ƒë·∫∑c tr∆∞ng h·ª£p l√Ω v·ªõi chu·ªói c√≥ m√πa v·ª• m·∫°nh, v√¨ s·ª± chuy·ªÉn pha gi·ªØa tƒÉng ‚Äì gi·∫£m lu√¥n ti·ªÅm ·∫©n r·ªßi ro d·ª± b√°o cao h∆°n.         


#### *Step 5: K·∫øt lu·∫≠n:*    

Trong ph·∫ßn nghi√™n c·ª©u n√†y, ch√∫ng t√¥i ƒë√£ ti·∫øn h√†nh ph√¢n t√≠ch chu·ªói th·ªùi gian ƒë·ªëi v·ªõi bi·∫øn l∆∞·ª£t xem trang (`page_views`) b·∫±ng c√°c m√¥ h√¨nh ARIMA, SARIMA, SARIMAX nh·∫±m m·ª•c ti√™u d·ª± b√°o ng·∫Øn h·∫°n cho 15 v√† 30 ng√†y k·∫ø ti·∫øp.    

Th√¥ng qua qu√° tr√¨nh ki·ªÉm tra t√≠nh d·ª´ng, nh·∫≠n di·ªán y·∫øu t·ªë m√πa v·ª•, ƒë√°nh gi√° ph·∫ßn d∆∞ v√† so s√°nh c√°c ch·ªâ s·ªë AIC, BIC, AICc, RMSE, MAPE gi·ªØa c√°c m√¥ h√¨nh, ch√∫ng t√¥i nh·∫≠n th·∫•y r·∫±ng m√¥ h√¨nh $\text{SARIMA}(5,0,2)√ó(1,1,1)_7$ l√† m√¥ h√¨nh ph√π h·ª£p nh·∫•t cho d·ªØ li·ªáu n√†y. M√¥ h√¨nh ƒë√£ ph·∫£n √°nh t·ªët c·∫•u tr√∫c m√πa v·ª• theo tu·∫ßn v√† cho k·∫øt qu·∫£ d·ª± b√°o ·ªïn ƒë·ªãnh v·ªõi sai s·ªë th·∫•p.      

M√¥ h√¨nh ƒë∆∞·ª£c l·ª±a ch·ªçn kh√¥ng ch·ªâ th·ªÉ hi·ªán hi·ªáu qu·∫£ t·ªët qua c√°c ch·ªâ s·ªë ƒëo l∆∞·ªùng tr√™n t·∫≠p hu·∫•n luy·ªán, m√† c√≤n ƒë∆∞·ª£c x√°c nh·∫≠n th√¥ng qua ki·ªÉm tra overfitting v·ªõi t·∫≠p ki·ªÉm ƒë·ªãnh. Sai s·ªë d·ª± b√°o tr√™n d·ªØ li·ªáu ki·ªÉm tra cho th·∫•y m√¥ h√¨nh t·ªïng qu√°t h√≥a t·ªët, kh√¥ng b·ªã qu√° kh·ªõp v√† gi·ªØ ƒë∆∞·ª£c ƒë·ªô ch√≠nh x√°c khi √°p d·ª•ng v√†o d·ªØ li·ªáu.    

Ngo√†i ra, k·∫øt qu·∫£ d·ª± b√°o cho 15 v√† 30 ng√†y ti·∫øp theo ƒë·ªÅu ph·∫£n √°nh r√µ t√≠nh m√πa v·ª• theo chu k·ª≥ 7 ng√†y, v·ªõi c√°c ƒë·ªânh v√† ƒë√°y l·∫∑p l·∫°i ƒë·ªÅu ƒë·∫∑n. D·∫£i sai s·ªë chu·∫©n v√† kho·∫£ng tin c·∫≠y 95% c≈©ng tƒÉng nh·∫π theo th·ªùi gian ‚Äì ƒë·∫∑c tr∆∞ng h·ª£p l√Ω ƒë·ªëi v·ªõi d·ª± b√°o chu·ªói th·ªùi gian ‚Äì v√† dao ƒë·ªông theo nh·ªãp tu·∫ßn, cho th·∫•y m√¥ h√¨nh ƒë√£ h·ªçc ƒë∆∞·ª£c kh√¥ng ch·ªâ xu h∆∞·ªõng trung t√¢m m√† c·∫£ ƒë·∫∑c t√≠nh b·∫•t ƒë·ªãnh theo m√πa.    

Trong t∆∞∆°ng lai, vi·ªác t√≠ch h·ª£p th√™m c√°c bi·∫øn ngo·∫°i sinh c√≥ t√≠nh phi tuy·∫øn c√≥ th·ªÉ l√† m·ªôt h∆∞·ªõng m·ªü nh·∫±m n√¢ng cao h∆°n n·ªØa hi·ªáu nƒÉng d·ª± b√°o khi h√†nh vi ng∆∞·ªùi d√πng tr·ªü n√™n ph·ª©c t·∫°p h∆°n.    